'use client'

import { animate, motion, useMotionValue } from 'motion/react'
import { useEffect } from 'react'

const DEFAULT_SHAPE =
  'M43.3,-75.5C57,-67.1,69.5,-57.2,77,-44.4C84.5,-31.6,87,-15.8,87.4,0.3C87.9,16.3,86.4,32.6,79.1,45.9C71.8,59.1,58.8,69.2,44.6,76.6C30.5,84,15.3,88.8,-0.4,89.4C-16,90.1,-32,86.6,-46,79.1C-60.1,71.6,-72.2,60.2,-79.3,46.3C-86.4,32.5,-88.4,16.2,-87.4,0.6C-86.4,-15.1,-82.3,-30.1,-75,-43.5C-67.6,-56.9,-57,-68.6,-43.9,-77.4C-30.9,-86.1,-15.4,-92,-0.3,-91.5C14.8,-91,29.6,-84,43.3,-75.5Z'

const BLOB_SHAPES = {
  idle: [
    'M43.1,-75.2C56.2,-67.2,67.1,-56.2,75,-43.1C82.8,-30.1,87.6,-15,87.4,-0.1C87.2,14.8,82,29.5,74.3,42.9C66.6,56.3,56.5,68.3,43.7,77.1C30.9,85.8,15.5,91.2,0.1,91C-15.3,90.8,-30.5,85,-43.9,76.7C-57.2,68.3,-68.7,57.3,-77.4,44.1C-86.1,30.8,-92,15.4,-91.8,0.1C-91.6,-15.2,-85.2,-30.4,-76.8,-44.1C-68.5,-57.8,-58,-70.1,-44.9,-78C-31.7,-85.9,-15.9,-89.5,-0.4,-88.8C15.1,-88.2,30.1,-83.2,43.1,-75.2Z',
    'M45.9,-79.6C59,-72,68.7,-58.6,75.1,-44.4C81.5,-30.2,84.6,-15.1,84.6,0C84.6,15.1,81.5,30.2,75,44.3C68.5,58.4,58.7,71.5,45.6,79.6C32.6,87.8,16.3,90.9,0.4,90.2C-15.5,89.6,-31,85.1,-45.2,77.6C-59.4,70.1,-72.2,59.6,-80.1,46.2C-88,32.7,-91,16.4,-90,0.6C-89,-15.2,-83.9,-30.4,-75.8,-43.4C-67.7,-56.5,-56.5,-67.5,-43.4,-75C-30.2,-82.5,-15.1,-86.6,0.7,-87.7C16.4,-88.9,32.9,-87.1,45.9,-79.6Z',
    'M43,-75.5C56.4,-66.7,68.6,-56.6,76.9,-43.9C85.1,-31.1,89.5,-15.5,89.6,0.1C89.7,15.7,85.6,31.3,78.2,45.7C70.8,60,60.2,73,46.7,81C33.1,89.1,16.5,92.1,0.4,91.5C-15.8,90.9,-31.6,86.5,-45.8,78.8C-59.9,71.1,-72.3,60,-80.4,46.3C-88.5,32.6,-92.1,16.3,-92.4,-0.2C-92.7,-16.6,-89.5,-33.3,-81.4,-46.8C-73.3,-60.4,-60.2,-70.9,-45.8,-79.3C-31.4,-87.6,-15.7,-93.7,-0.5,-92.9C14.8,-92.1,29.5,-84.4,43,-75.5Z',
    'M43.2,-75.5C56.2,-67.4,67,-56.2,75.8,-43.1C84.5,-30,91.2,-15,91.6,0.2C92,15.4,86,30.8,78,45.2C69.9,59.5,59.8,72.8,46.5,81.2C33.1,89.5,16.6,93,0.4,92.2C-15.7,91.5,-31.4,86.6,-44.4,78C-57.3,69.4,-67.5,57.1,-76.2,43.5C-84.8,29.9,-91.9,14.9,-92.6,-0.4C-93.2,-15.7,-87.4,-31.4,-78.4,-44.3C-69.3,-57.3,-57.1,-67.4,-43.5,-75.2C-29.9,-82.9,-14.9,-88.2,0.1,-88.4C15.1,-88.6,30.2,-83.6,43.2,-75.5Z',
    'M46.7,-79.6C61.1,-72.6,73.5,-61.2,82.1,-47.1C90.6,-33.1,95.2,-16.6,94,-0.7C92.9,15.3,86.1,30.5,77,43.6C68,56.8,56.8,67.8,43.5,76.6C30.3,85.4,15.2,92.1,-0.1,92.3C-15.4,92.5,-30.8,86.3,-44.9,78C-59,69.7,-71.8,59.3,-79.1,45.9C-86.3,32.6,-88,16.3,-87.9,0C-87.8,-16.2,-86,-32.4,-78.5,-45.3C-71.1,-58.3,-57.9,-67.9,-43.9,-75C-29.8,-82.2,-14.9,-86.8,0.6,-87.9C16.2,-89,32.4,-86.6,46.7,-79.6Z',
  ],
  soft: [
    'M43.1,-77.6C54,-68.4,59.5,-53,65.9,-39C72.3,-25.1,79.6,-12.5,82.3,1.6C85,15.7,83.3,31.4,75.1,42.3C67,53.3,52.5,59.5,38.9,66.7C25.3,73.9,12.6,82,-1.3,84.2C-15.2,86.4,-30.4,82.7,-43.2,75.1C-56,67.5,-66.4,55.9,-73.1,42.8C-79.8,29.6,-82.8,14.8,-83.6,-0.5C-84.5,-15.8,-83.2,-31.5,-75.8,-43.4C-68.4,-55.3,-54.8,-63.4,-41.1,-70.9C-27.5,-78.4,-13.7,-85.3,1.2,-87.4C16.1,-89.5,32.3,-86.7,43.1,-77.6Z',
    'M38.4,-65.3C51.3,-59,64.5,-51.9,73,-40.9C81.4,-29.9,85.1,-15,85.6,0.3C86,15.5,83.3,31,76.1,44.1C68.8,57.2,57.2,68,43.7,74.8C30.3,81.7,15.2,84.6,0.2,84.3C-14.8,84,-29.7,80.6,-41,72.5C-52.4,64.5,-60.2,51.9,-66,39.1C-71.8,26.2,-75.6,13.1,-75.2,0.2C-74.8,-12.7,-70.4,-25.4,-65.3,-39.4C-60.2,-53.5,-54.4,-68.9,-43.5,-76.3C-32.5,-83.7,-16.2,-83.1,-1.8,-80.1C12.7,-77,25.4,-71.5,38.4,-65.3Z',
    'M38,-66.6C49.4,-59.3,58.7,-49.3,65.4,-37.7C72.1,-26.2,76.2,-13.1,77,0.5C77.8,14,75.3,28,70,42.1C64.8,56.3,56.9,70.6,44.8,79.7C32.6,88.8,16.3,92.9,1,91.1C-14.3,89.3,-28.5,81.7,-42.3,73.5C-56,65.3,-69.3,56.5,-78.1,44.1C-87,31.8,-91.5,15.9,-91.9,-0.2C-92.2,-16.3,-88.3,-32.5,-79.9,-45.6C-71.5,-58.8,-58.5,-68.7,-44.4,-74.4C-30.3,-80.1,-15.2,-81.5,-0.9,-80C13.4,-78.4,26.7,-73.9,38,-66.6Z',
    'M38.6,-65.5C50.9,-59.8,62.5,-51.2,72,-39.9C81.6,-28.5,89.3,-14.2,88.8,-0.3C88.4,13.7,79.9,27.5,70.4,39C60.8,50.4,50.3,59.7,38.4,67.9C26.5,76.1,13.3,83.2,-1.6,86C-16.5,88.9,-33.1,87.4,-47.2,80.5C-61.4,73.7,-73.2,61.4,-79.3,47C-85.5,32.7,-85.9,16.4,-84.2,1C-82.4,-14.3,-78.5,-28.7,-72.3,-42.9C-66.1,-57.1,-57.6,-71.1,-45.2,-76.8C-32.8,-82.5,-16.4,-79.9,-1.6,-77.1C13.1,-74.3,26.3,-71.3,38.6,-65.5Z',
    'M40.7,-66.9C55.1,-62.2,70.8,-56.1,79.4,-44.7C88,-33.3,89.5,-16.6,89.3,-0.1C89.1,16.5,87.3,32.9,79.5,45.7C71.7,58.4,57.9,67.4,43.7,72.9C29.4,78.3,14.7,80.1,0.9,78.6C-13,77.2,-26,72.4,-38.6,66C-51.2,59.6,-63.3,51.6,-72,40.3C-80.6,29,-85.8,14.5,-86.9,-0.6C-88,-15.8,-84.9,-31.5,-77.8,-45.4C-70.6,-59.3,-59.4,-71.3,-45.7,-76.5C-32.1,-81.6,-16,-79.9,-1.4,-77.4C13.2,-74.9,26.3,-71.6,40.7,-66.9Z',
  ],
  hard: [
    'M35.3,-62.3C48.7,-53.5,64.4,-49.8,70.4,-40.3C76.5,-30.8,72.9,-15.4,72.7,-0.1C72.5,15.1,75.6,30.3,71.6,43.4C67.6,56.5,56.5,67.6,43.4,72.3C30.3,77.1,15.1,75.5,0.4,74.7C-14.2,73.9,-28.5,74,-41.1,68.9C-53.7,63.9,-64.6,53.8,-68.7,41.4C-72.7,29.1,-69.9,14.6,-66.8,1.8C-63.7,-11,-60.4,-22,-56.2,-34.1C-52,-46.1,-46.9,-59.3,-37.4,-70.4C-27.9,-81.4,-13.9,-90.4,-1.5,-87.9C11,-85.3,22,-71.2,35.3,-62.3Z',
    'M37.8,-64.1C51.2,-57.7,66,-52.1,70.6,-41.6C75.2,-31.1,69.6,-15.5,70.2,0.3C70.7,16.2,77.5,32.4,73.2,43.6C69,54.7,53.8,60.8,39.8,68.4C25.8,75.9,12.9,84.8,0.4,84.1C-12.1,83.5,-24.2,73.2,-34.3,63.4C-44.4,53.6,-52.5,44.3,-60,33.8C-67.4,23.3,-74.1,11.7,-75.1,-0.6C-76.1,-12.8,-71.4,-25.7,-64.1,-36.5C-56.9,-47.3,-47.2,-56.1,-36.1,-63.9C-25,-71.6,-12.5,-78.3,-0.2,-78C12.2,-77.7,24.3,-70.5,37.8,-64.1Z',
    'M32.5,-57.8C42,-50.7,49.6,-41.9,60.5,-32C71.3,-22,85.4,-11,89.6,2.4C93.7,15.8,88,31.7,79,44.8C70,57.8,57.7,68.2,43.9,73C30.2,77.9,15.1,77.3,0.1,77.2C-15,77.1,-29.9,77.4,-40.9,71C-51.9,64.5,-58.9,51.3,-65.2,38.4C-71.5,25.4,-77,12.7,-75.1,1.1C-73.3,-10.6,-64,-21.1,-57.8,-34.2C-51.6,-47.2,-48.4,-62.8,-39.3,-70.1C-30.2,-77.3,-15.1,-76.3,-1.8,-73.2C11.5,-70.1,22.9,-64.8,32.5,-57.8Z',
    'M37,-60.6C51.1,-56,67.8,-52.4,73.3,-42.4C78.8,-32.5,73.1,-16.2,70.5,-1.5C67.9,13.2,68.4,26.5,64.4,39C60.4,51.6,51.9,63.4,40.4,71.9C28.9,80.4,14.5,85.7,1.5,83.2C-11.5,80.6,-23,70.2,-37.2,63.2C-51.3,56.2,-68.1,52.6,-77.8,42.7C-87.5,32.7,-90.2,16.3,-86.9,1.9C-83.7,-12.6,-74.7,-25.3,-65.5,-36.2C-56.4,-47.1,-47.1,-56.2,-36.1,-62.6C-25.2,-69,-12.6,-72.7,-0.5,-71.8C11.5,-70.8,23,-65.2,37,-60.6Z',
    'M42.4,-71.1C55.9,-65.6,68.4,-56.2,76.1,-43.6C83.8,-31.1,86.7,-15.6,86.3,-0.3C85.8,15,82,30.1,74.7,43.4C67.5,56.7,56.7,68.2,43.7,72.6C30.7,76.9,15.3,74.1,-0.3,74.7C-16,75.3,-32,79.2,-42.6,73.4C-53.2,67.7,-58.4,52.2,-63.5,38.4C-68.5,24.5,-73.3,12.2,-73.4,-0.1C-73.5,-12.4,-69,-24.8,-62,-35.3C-55,-45.7,-45.6,-54.3,-34.9,-61.3C-24.2,-68.4,-12.1,-73.8,1.2,-75.9C14.5,-77.9,28.9,-76.5,42.4,-71.1Z',
  ],
  intense: [
    'M32.4,-56.3C45.3,-48.6,61.6,-46.8,67.8,-38.4C74,-30,70.3,-15,65.8,-2.6C61.3,9.8,56,19.5,51.9,31.6C47.8,43.6,44.7,57.9,36.3,63.5C27.8,69.1,13.9,66,1.8,62.9C-10.2,59.7,-20.4,56.4,-33.8,53.6C-47.2,50.9,-63.7,48.6,-67,39.7C-70.2,30.9,-60.1,15.4,-60.3,-0.1C-60.5,-15.7,-71,-31.3,-70.9,-45.7C-70.8,-60,-60.3,-73,-46.7,-80.4C-33.1,-87.7,-16.6,-89.3,-3.4,-83.4C9.7,-77.5,19.4,-63.9,32.4,-56.3Z',
    'M37.5,-64.6C45.8,-60.2,47.7,-44.4,54.6,-31.8C61.5,-19.1,73.2,-9.6,77.4,2.4C81.6,14.4,78.2,28.8,70.8,40.5C63.4,52.2,52,61.3,39.6,63.8C27.1,66.4,13.6,62.3,1.6,59.5C-10.4,56.8,-20.7,55.3,-34.2,53.3C-47.6,51.4,-64.1,49,-74,40C-83.9,31,-87.2,15.5,-87.3,0C-87.4,-15.6,-84.2,-31.2,-74,-39.6C-63.8,-48.1,-46.5,-49.3,-33,-50.8C-19.5,-52.2,-9.7,-53.8,2.4,-58C14.6,-62.2,29.2,-69.1,37.5,-64.6Z',
    'M36,-63.8C45.6,-56.8,51.5,-45,57.5,-33.6C63.4,-22.1,69.4,-11.1,67.8,-0.9C66.2,9.2,57,18.4,49.7,27.5C42.3,36.5,36.9,45.5,28.9,49.5C21,53.4,10.5,52.4,-2.4,56.6C-15.3,60.8,-30.7,70.3,-40.9,67.6C-51,64.9,-56.1,50.1,-58.5,36.8C-60.9,23.5,-60.6,11.8,-61.8,-0.7C-63,-13.1,-65.7,-26.3,-62.4,-38.1C-59.2,-49.9,-50,-60.3,-38.6,-66.2C-27.2,-72.1,-13.6,-73.5,-0.2,-73.1C13.2,-72.8,26.4,-70.7,36,-63.8Z',
    'M38.9,-62.8C51,-60.3,61.8,-51.1,68.3,-39.5C74.7,-27.9,76.9,-14,76,-0.5C75.2,13,71.4,26,63,34.4C54.7,42.7,41.8,46.4,30.6,55.5C19.3,64.6,9.6,79.1,-0.7,80.2C-11,81.4,-22,69.3,-32.2,59.6C-42.4,49.9,-51.9,42.7,-58.2,33.1C-64.5,23.6,-67.7,11.8,-67.5,0.1C-67.4,-11.6,-63.8,-23.2,-58.9,-35.1C-54,-47.1,-47.7,-59.4,-37.7,-63.1C-27.6,-66.7,-13.8,-61.7,-0.2,-61.3C13.4,-60.9,26.8,-65.2,38.9,-62.8Z',
    'M32.2,-54.9C46.1,-47.7,64.8,-47.9,69.4,-40C74,-32.1,64.5,-16.1,58.8,-3.3C53.1,9.4,51,18.8,46.4,26.7C41.7,34.6,34.5,40.9,26.3,50.2C18.1,59.5,9.1,71.8,0,71.9C-9.1,71.9,-18.2,59.7,-28,51.2C-37.7,42.8,-48.1,38.3,-53.7,30.4C-59.2,22.5,-60.1,11.2,-64.2,-2.4C-68.4,-16,-75.8,-32.1,-70.5,-40.5C-65.2,-48.9,-47.1,-49.6,-33.3,-56.8C-19.4,-63.9,-9.7,-77.6,-0.3,-77.1C9.1,-76.6,18.3,-62.1,32.2,-54.9Z',
  ],
}

const ANIMATION_DURATIONS: Record<keyof typeof BLOB_SHAPES, number> = {
  idle: 15,
  soft: 10,
  hard: 7.5,
  intense: 4,
}

export type BlobAnimation = keyof typeof BLOB_SHAPES

export type BlobProps = {
  animation?: BlobAnimation
}

export function Blob({ animation = 'idle' }: Readonly<BlobProps>) {
  const shape = useMotionValue(DEFAULT_SHAPE)

  useEffect(() => {
    const current = shape.get()
    const targetShapes = [current, ...BLOB_SHAPES[animation]]

    animate(shape, targetShapes, {
      ease: 'easeInOut',
      duration: ANIMATION_DURATIONS[animation],
      repeat: Infinity,
      repeatType: 'mirror',
    })
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [animation])

  return (
    <motion.svg
      // key={`${animation}-blob`}
      // ref={scopeSVG}
      viewBox="0 0 200 200"
      xmlns="http://www.w3.org/2000/svg"
      // initial={{ opacity: 1 }}
      // animate={{ opacity: 1 }}
      // exit={{ opacity: 0.75 }}
      // transition={{ ease: 'easeInOut', duration: 0.25 }}
    >
      <defs>
        <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
          <feDropShadow
            dx="0"
            dy="4"
            stdDeviation="8"
            floodColor="rgb(244 114 182)"
            floodOpacity="0.5"
          />
        </filter>
      </defs>

      <motion.path
        filter="url(#shadow)"
        className="fill-slate-950 stroke-white/30"
        transform="translate(100 100)"
        d={shape}
      />
    </motion.svg>
  )
}
